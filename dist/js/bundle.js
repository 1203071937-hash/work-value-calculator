(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(e){if("string"==typeof e)return n(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a(o.key),o)}}function a(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var r=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cityData={华北地区:{北京:{factor:.7,level:"超一线城市"},天津:{factor:.8,level:"一线城市"},石家庄:{factor:1,level:"二线城市"},太原:{factor:1,level:"二线城市"},呼和浩特:{factor:1.1,level:"二线城市"}},华东地区:{上海:{factor:.7,level:"超一线城市"},南京:{factor:.9,level:"新一线城市"},杭州:{factor:.9,level:"新一线城市"},宁波:{factor:1,level:"二线城市"},苏州:{factor:.95,level:"新一线城市"},无锡:{factor:1,level:"二线城市"},常州:{factor:1.05,level:"二线城市"},南通:{factor:1.05,level:"二线城市"},扬州:{factor:1.05,level:"二线城市"},徐州:{factor:1.05,level:"二线城市"},合肥:{factor:1,level:"二线城市"},福州:{factor:1,level:"二线城市"},厦门:{factor:.95,level:"新一线城市"},泉州:{factor:1.05,level:"二线城市"},青岛:{factor:.95,level:"新一线城市"},济南:{factor:1,level:"二线城市"},烟台:{factor:1.05,level:"二线城市"},潍坊:{factor:1.05,level:"二线城市"}},华南地区:{广州:{factor:.85,level:"一线城市"},深圳:{factor:.8,level:"一线城市"},珠海:{factor:1,level:"二线城市"},佛山:{factor:1,level:"二线城市"},东莞:{factor:1,level:"二线城市"},中山:{factor:1.05,level:"二线城市"},惠州:{factor:1.05,level:"二线城市"},南宁:{factor:1,level:"二线城市"},海口:{factor:1,level:"二线城市"}},华中地区:{武汉:{factor:1,level:"新一线城市"},长沙:{factor:1,level:"新一线城市"},郑州:{factor:1,level:"新一线城市"},南昌:{factor:1,level:"二线城市"},洛阳:{factor:1.05,level:"二线城市"},襄阳:{factor:1.05,level:"二线城市"},宜昌:{factor:1.05,level:"二线城市"}},西南地区:{成都:{factor:1,level:"新一线城市"},重庆:{factor:1,level:"新一线城市"},昆明:{factor:1,level:"二线城市"},贵阳:{factor:1,level:"二线城市"},拉萨:{factor:1.1,level:"三线城市"}},西北地区:{西安:{factor:1.1,level:"二线城市"},兰州:{factor:1.1,level:"二线城市"},西宁:{factor:1.1,level:"三线城市"},银川:{factor:1.1,level:"三线城市"},乌鲁木齐:{factor:1.1,level:"二线城市"}},东北地区:{沈阳:{factor:1,level:"二线城市"},大连:{factor:1,level:"二线城市"},长春:{factor:1,level:"二线城市"},哈尔滨:{factor:1,level:"二线城市"}}},this.cityFactors={北京:1.3,上海:1.3,深圳:1.25,广州:1.2,杭州:1.15,南京:1.1,成都:1.05,武汉:1.05,西安:1,重庆:1,苏州:1.1,天津:1.05,长沙:1,青岛:1,宁波:1,无锡:1,厦门:.95,大连:.9,佛山:.9,东莞:.9,济南:.9,合肥:.85,福州:.85,南昌:.85,郑州:.85,哈尔滨:.8,沈阳:.8,长春:.8,石家庄:.75,太原:.75,呼和浩特:.7,兰州:.7,西宁:.65,银川:.65,其他:.6},this.educationBaseExpectations={专科:{base:4500,growth:1,maxYears:15,ageExpectations:{20:4500,22:5e3,25:6e3,28:7e3,30:8e3,35:9e3,40:1e4,45:11e3,50:12e3}},本科:{base:6500,growth:1.2,maxYears:20,ageExpectations:{22:6500,24:7500,25:8e3,28:1e4,30:12e3,32:14e3,35:16e3,38:18e3,40:2e4,45:25e3,50:3e4}},硕士:{base:9e3,growth:1.4,maxYears:25,ageExpectations:{25:9e3,26:1e4,28:12e3,30:15e3,32:18e3,35:22e3,38:26e3,40:3e4,42:34e3,45:4e4,50:5e4}},博士:{base:15e3,growth:1.6,maxYears:30,ageExpectations:{28:15e3,29:17e3,30:2e4,32:25e3,35:32e3,38:4e4,40:45e3,42:5e4,45:6e4,48:7e4,50:8e4}}},this.schoolRankFactors={普通院校:1,"211院校":1.15,"985院校":1.25,顶尖院校:1.4},this.workTypeFactors={私企:1,外企:1.2,国企:1.1,事业编:1.25,公务员:1.3,创业:.8,其他:1},this.familyDistanceFactors={同城:1,省内:1.05,跨省:1.15,海外:1.4}},(a=[{key:"buildCityFactors",value:function(){var e={};return Object.values(this.cityData).forEach(function(n){Object.entries(n).forEach(function(n){var o=function(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,l,i=[],c=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(i.push(o.value),i.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return i}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n,2),a=o[0],r=o[1];e[a]=r.factor})}),e["其他"]=1.2,e}},{key:"getRegions",value:function(){return Object.keys(this.cityData)}},{key:"getCitiesByRegion",value:function(e){return this.cityData[e]?Object.keys(this.cityData[e]):[]}},{key:"getCityInfo",value:function(e){for(var t=0,n=Object.values(this.cityData);t<n.length;t++){var o=n[t];if(o[e])return o[e]}return{factor:1,level:"其他城市"}}},{key:"calculateIncomeIndex",value:function(e){e.salary;var t=e.afterTax,n=e.allowance,o=e.insuranceBase,a=e.fundRate,r=e.otherBenefits,l=e.city,i=e.education,c=e.schoolRank,u=e.age,d=this.cityFactors[l]||1,s=this.schoolRankFactors[c]||1;if(!this.educationBaseExpectations[i])return console.error("未找到学历配置:",i),{incomeIndex:0,error:"学历配置错误"};var m=this.getExpectedIncomeByAge(i,u),v=m>0?t/m:1,f=this.calculateSocialInsurance(o),y=this.calculateHousingFund(o,a),p=t+y+r,h=p/5e3*100;return h=h*d*v*s,{incomeIndex:Math.round(100*h)/100,totalIncome:Math.round(100*p)/100,socialInsurance:Math.round(100*f)/100,housingFund:Math.round(100*y)/100,cityFactor:d,educationFactor:v,schoolRankFactor:s,expectedIncome:m,cityInfo:this.getCityInfo(l),breakdown:{afterTax:t,housingFund:y,otherBenefits:r,allowance:n}}}},{key:"calculateSocialInsurance",value:function(e){return.36*e}},{key:"calculateHousingFund",value:function(e,t){return e*t*.02}},{key:"getExpectedIncomeByAge",value:function(e,o){var a=this.educationBaseExpectations[e];if(!a)return console.error("未找到学历配置:",e),0;var r=a.ageExpectations;return r[o]?r[o]:r[Math.max.apply(Math,function(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object.keys(r).map(Number)))]||0}},{key:"getWeight",value:function(){return.6}}])&&o(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,a}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,c(o.key),o)}}function c(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var u=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.standardWorkHours=8,this.standardCommuteHours=1,this.standardWorkIntensity=3,this.standardWorkDays=5},(t=[{key:"calculateWorkIndex",value:function(e){var t=e.workStart,n=e.workEnd,o=e.commuteTime,a=e.overtimeFreq,r=e.overtimeHours,l=e.workIntensity,i=e.workDays,c=e.age,u=n-t,d=2*o/60,s=this.calculateTimeCostIndex(u,d),m=this.calculateIntensityCostIndex(l),v=this.calculateOvertimeCostIndex(a,r),f=i/this.standardWorkDays,y=this.calculateAgeFactor(c),p=(s+m+v)*y*f/10;return{workIndex:Math.max(1,Math.round(100*p)/100),timeCostIndex:Math.round(100*s)/100,intensityCostIndex:Math.round(100*m)/100,overtimeCostIndex:Math.round(100*v)/100,workDaysFactor:Math.round(100*f)/100,ageFactor:Math.round(100*y)/100,breakdown:{workHours:u,commuteHours:d,workDays:i,age:c}}}},{key:"calculateTimeCostIndex",value:function(e,t){return(e+t)/(this.standardWorkHours+this.standardCommuteHours)*30}},{key:"calculateIntensityCostIndex",value:function(e){return e/this.standardWorkIntensity*20}},{key:"calculateOvertimeCostIndex",value:function(e,t){var n=e+t;return n/Math.max(.1,n)*10}},{key:"calculateAgeFactor",value:function(e){return 1+.02*(e-25)}},{key:"getWeight",value:function(){return.25}}])&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,m(o.key),o)}}function m(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}var v=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.standardRent=2e3,this.standardFood=1500,this.standardTransport=500},(t=[{key:"calculateCostIndex",value:function(e){var t=e.rent,n=e.food,o=e.transport,a=e.afterTax,r=e.familyDistance,l=t+n+o,i=l/a,c=100;i>0&&(c=i<=.3?90:i<=.5?75:i<=.7?60:i<=1?40:20);var u=this.getFamilyDistanceFactor(r),d=c*u;return{costIndex:Math.round(100*d)/100,totalCost:l,costIncomeRatio:Math.round(1e3*i)/1e3,familyDistanceFactor:u,breakdown:{rent:t,food:n,transport:o}}}},{key:"getFamilyDistanceFactor",value:function(e){return{同城:1,省内:1.1,跨省:1.2,海外:1.5}[e]||1}},{key:"calculateCostBenefitRatio",value:function(e,t){return 0===t?0:Math.round(e/t*100)/100}},{key:"getWeight",value:function(){return.1}}])&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,p(o.key),o)}}function p(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var h=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.experienceWeights={housingSatisfaction:.25,consumptionSatisfaction:.2,transportSatisfaction:.15,lifeAtmosphere:.2,workAtmosphere:.2}},(t=[{key:"calculateExperienceIndex",value:function(e){var t=this,n=(e.housingSatisfaction,e.consumptionSatisfaction,e.transportSatisfaction,e.lifeAtmosphere,e.workAtmosphere,this.validateExperienceData(e)),o=0;return Object.keys(this.experienceWeights).forEach(function(e){o+=n[e]*t.experienceWeights[e]}),o*=10,{experienceIndex:Math.round(100*o)/100,weightedScores:{housingSatisfaction:Math.round(10*n.housingSatisfaction*100)/100,consumptionSatisfaction:Math.round(10*n.consumptionSatisfaction*100)/100,transportSatisfaction:Math.round(10*n.transportSatisfaction*100)/100,lifeAtmosphere:Math.round(10*n.lifeAtmosphere*100)/100,workAtmosphere:Math.round(10*n.workAtmosphere*100)/100},weights:this.experienceWeights,breakdown:n}}},{key:"validateExperienceData",value:function(e){var t={};return Object.keys(e).forEach(function(n){var o=parseFloat(e[n])||5;o=Math.max(1,Math.min(10,o)),t[n]=o}),t}},{key:"getExperienceEvaluation",value:function(e){return e>=90?"极佳体验，工作生活平衡完美！":e>=80?"优秀体验，整体满意度很高！":e>=70?"良好体验，大部分方面令人满意！":e>=60?"一般体验，有提升空间！":e>=50?"较差体验，需要改善！":"很差体验，建议重新考虑！"}},{key:"getWeight",value:function(){return.2}}])&&y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function E(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,I(o.key),o)}}function I(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}var b=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.incomeCalculator=new r,this.workCalculator=new u,this.costCalculator=new v,this.experienceCalculator=new h,this.init()},t=[{key:"init",value:function(){this.bindEvents(),this.initCitySelector()}},{key:"initCitySelector",value:function(){var e=this,t=document.getElementById("region"),n=document.getElementById("city");if(t&&n){var o=this.incomeCalculator.getRegions();t.innerHTML='<option value="">请选择地区</option>',o.forEach(function(e){var n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}),t.addEventListener("change",function(t){var o=t.target.value;n.innerHTML='<option value="">请选择城市</option>',o&&e.incomeCalculator.getCitiesByRegion(o).forEach(function(e){var t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)})})}}},{key:"bindEvents",value:function(){var e=this;document.getElementById("calculatorForm").addEventListener("submit",function(t){t.preventDefault(),e.calculateValue()}),document.getElementById("resetBtn").addEventListener("click",function(){e.resetForm()}),document.getElementById("showLogicBtn").addEventListener("click",function(){window.open("calculation-logic.html","_blank")}),document.getElementById("loadExampleBtn").addEventListener("click",function(){e.loadExampleData()}),document.getElementById("region").addEventListener("change",function(t){e.updateCityOptions(t.target.value)}),document.getElementById("insuranceStatus").addEventListener("change",function(t){e.handleInsuranceStatusChange(t.target.value)}),document.getElementById("fundRate").addEventListener("change",function(t){e.handleFundRateChange(t.target.value)}),document.getElementById("customFundAmount").addEventListener("input",function(){e.calculateAfterTax()}),["salary","insuranceBase","fundRate","allowance","otherBenefits"].forEach(function(t){var n=document.getElementById(t);n&&n.addEventListener("input",function(){e.calculateAfterTax()})}),document.getElementById("closeModalBtn").addEventListener("click",function(){e.closeModal()}),window.addEventListener("click",function(t){t.target===document.getElementById("resultModal")&&e.closeModal()})}},{key:"calculateValue",value:function(){try{var e=this.collectFormData();if(!this.validateFormData(e))return;var t=this.incomeCalculator.calculateIncomeIndex(e),n=this.workCalculator.calculateWorkIndex(e),o=this.costCalculator.calculateCostIndex(e),a=this.experienceCalculator.calculateExperienceIndex(e),r=this.calculateTotalScore({income:t.incomeIndex,work:n.workIndex,cost:o.costIndex,experience:a.experienceIndex}),l=this.getEvaluation(r.totalScore);this.displayResult({totalScore:r,evaluation:l,incomeResult:t,workResult:n,costResult:o,experienceResult:a,formData:e})}catch(e){console.error("计算过程中出现错误:",e),alert("计算过程中出现错误，请检查输入数据！")}}},{key:"collectFormData",value:function(){var e,t,n,o,a,r,l,i,c,u,d,s,m,v,f,y,p,h,g,E,I,b,B,k,x,w,S,C={};return C.name=(null===(e=document.getElementById("name"))||void 0===e?void 0:e.value)||"匿名用户",C.region=(null===(t=document.getElementById("region"))||void 0===t?void 0:t.value)||"",C.city=(null===(n=document.getElementById("city"))||void 0===n?void 0:n.value)||"其他",C.age=parseFloat(null===(o=document.getElementById("age"))||void 0===o?void 0:o.value)||25,C.education=(null===(a=document.getElementById("education"))||void 0===a?void 0:a.value)||"本科",C.schoolRank=(null===(r=document.getElementById("schoolRank"))||void 0===r?void 0:r.value)||"普通院校",C.salary=parseFloat(null===(l=document.getElementById("salary"))||void 0===l?void 0:l.value)||0,C.afterTax=parseFloat(null===(i=document.getElementById("afterTax"))||void 0===i?void 0:i.value)||0,C.allowance=parseFloat(null===(c=document.getElementById("allowance"))||void 0===c?void 0:c.value)||0,C.insuranceBase=parseFloat(null===(u=document.getElementById("insuranceBase"))||void 0===u?void 0:u.value)||0,C.fundRate=parseFloat(null===(d=document.getElementById("fundRate"))||void 0===d?void 0:d.value)||.12,C.otherBenefits=parseFloat(null===(s=document.getElementById("otherBenefits"))||void 0===s?void 0:s.value)||0,C.workStart=parseFloat(null===(m=document.getElementById("workStart"))||void 0===m?void 0:m.value)||9,C.workEnd=parseFloat(null===(v=document.getElementById("workEnd"))||void 0===v?void 0:v.value)||18,C.commuteTime=parseFloat(null===(f=document.getElementById("commuteTime"))||void 0===f?void 0:f.value)||60,C.overtimeFreq=parseFloat(null===(y=document.getElementById("overtimeFreq"))||void 0===y?void 0:y.value)||0,C.overtimeHours=parseFloat(null===(p=document.getElementById("overtimeHours"))||void 0===p?void 0:p.value)||0,C.workIntensity=parseFloat(null===(h=document.getElementById("workIntensity"))||void 0===h?void 0:h.value)||3,C.workDays=parseFloat(null===(g=document.getElementById("workDays"))||void 0===g?void 0:g.value)||5,C.rent=parseFloat(null===(E=document.getElementById("rent"))||void 0===E?void 0:E.value)||0,C.food=parseFloat(null===(I=document.getElementById("food"))||void 0===I?void 0:I.value)||0,C.transport=parseFloat(null===(b=document.getElementById("transport"))||void 0===b?void 0:b.value)||0,C.housingSatisfaction=parseFloat(null===(B=document.getElementById("housingSatisfaction"))||void 0===B?void 0:B.value)||5,C.consumptionSatisfaction=parseFloat(null===(k=document.getElementById("consumptionSatisfaction"))||void 0===k?void 0:k.value)||5,C.transportSatisfaction=parseFloat(null===(x=document.getElementById("transportSatisfaction"))||void 0===x?void 0:x.value)||5,C.lifeAtmosphere=parseFloat(null===(w=document.getElementById("lifeAtmosphere"))||void 0===w?void 0:w.value)||5,C.workAtmosphere=parseFloat(null===(S=document.getElementById("workAtmosphere"))||void 0===S?void 0:S.value)||5,C}},{key:"validateFormData",value:function(e){return!e.afterTax||e.afterTax<=0?(alert("请输入有效的税后工资！"),!1):e.workEnd<=e.workStart?(alert("下班时间必须晚于上班时间！"),!1):!!e.city||(alert("请选择工作城市！"),!1)}},{key:"calculateTotalScore",value:function(e){var t={income:.5,work:.3,cost:.15,experience:.05},n={income:this.normalizeIncomeScore(e.income),work:Math.min(100,Math.max(0,e.work)),cost:Math.min(100,Math.max(0,e.cost)),experience:Math.min(100,Math.max(0,e.experience))},o=0;return o+=n.income*t.income,o+=(100-n.work)*t.work,o+=(100-n.cost)*t.cost,o+=n.experience*t.experience,o=Math.max(0,Math.min(100,o)),{totalScore:Math.round(100*o)/100,weights:t,normalizedScores:n,breakdown:{income:n.income*t.income,work:(100-n.work)*t.work,cost:(100-n.cost)*t.cost,experience:n.experience*t.experience}}}},{key:"normalizeIncomeScore",value:function(e){var t=15*Math.log(e+1),n=Math.min(85,60+t);return Math.max(0,Math.round(100*n)/100)}},{key:"getEvaluation",value:function(e){return e>=95?{grade:"天菜！",comment:"太棒了，你的公司在哪？我也要入职！",emoji:"🌟",recommendation:"这份工作性价比极高，建议立即接受！"}:e>=85?{grade:"优秀！",comment:"这工作性价比简直逆天，赶紧珍惜吧！",emoji:"✨",recommendation:"工作性价比很高，值得长期发展！"}:e>=75?{grade:"良好！",comment:"这份工作相当不错，值得考虑！",emoji:"👍",recommendation:"性价比不错，可以考虑接受这份工作！"}:e>=65?{grade:"一般！",comment:"还可以接受，但还有提升空间。",emoji:"😐",recommendation:"性价比一般，建议再看看其他机会！"}:e>=50?{grade:"及格！",comment:"勉强可以接受，但需要慎重考虑。",emoji:"😕",recommendation:"性价比偏低，除非特别需要这份工作，否则建议继续寻找！"}:{grade:"不及格！",comment:"这份工作性价比太低，不建议接受这份工作，继续寻找更好的机会吧！",emoji:"❌",recommendation:"性价比太低，不建议接受这份工作，继续寻找更好的机会吧！"}}},{key:"displayResult",value:function(e){this.updateResultPage(e),this.showResultModal(e)}},{key:"updateResultPage",value:function(e){console.log("计算结果:",e)}},{key:"showResultModal",value:function(e){var t=document.getElementById("resultModal");if(t){var n=document.getElementById("modalResultName"),o=document.getElementById("modalScore"),a=document.getElementById("modalGrade"),r=document.getElementById("modalComment"),l=document.getElementById("modalRecommendation"),i=document.getElementById("modalProgressBar");if(n&&(n.textContent=e.formData.name||"匿名用户"),o&&(o.textContent="".concat(e.totalScore.totalScore," 分")),a&&(a.textContent="等级：".concat(e.evaluation.grade)),r&&(r.textContent=e.evaluation.comment),l&&(l.textContent=e.evaluation.recommendation),i){var c=e.totalScore.totalScore;i.style.width="".concat(Math.min(c,100),"%"),i.style.backgroundColor=this.getScoreColor(c)}t.style.display="block",t.classList.add("show"),console.log("结果弹窗已显示:",e)}else console.error("未找到结果模态框")}},{key:"getScoreColor",value:function(e){return e>=90?"#4CAF50":e>=80?"#8BC34A":e>=70?"#FFC107":e>=60?"#FF9800":"#F44336"}},{key:"resetForm",value:function(){var e=document.getElementById("calculatorForm");e&&e.reset(),e.querySelectorAll("input, select").forEach(function(e){"number"===e.type?e.value=e.defaultValue||"":"select-one"===e.type&&(e.selectedIndex=0)}),this.initCitySelector()}},{key:"showCalculationLogic",value:function(){window.location.href="calculation-logic.html"}},{key:"handleInsuranceStatusChange",value:function(e){var t=document.getElementById("insuranceBase"),n=document.getElementById("fundRate"),o=document.getElementById("customFundAmountGroup");"不缴纳"===e?(t.disabled=!0,n.disabled=!0,o.style.display="none",n.value="不缴纳",t.value="",document.getElementById("customFundAmount").value=""):(t.disabled=!1,n.disabled=!1,"不缴纳"!==n.value&&this.handleFundRateChange(n.value)),this.calculateAfterTax()}},{key:"handleFundRateChange",value:function(e){var t=document.getElementById("customFundAmountGroup"),n=document.getElementById("customFundAmount");"固定金额"===e?(t.style.display="block",n.required=!0,n.focus()):(t.style.display="none",n.required=!1,n.value=""),this.calculateAfterTax()}},{key:"calculateAfterTax",value:function(){var e,t,n,o,a,r,l=parseFloat(null===(e=document.getElementById("salary"))||void 0===e?void 0:e.value)||0,i=parseFloat(null===(t=document.getElementById("insuranceBase"))||void 0===t?void 0:t.value)||0,c=(null===(n=document.getElementById("fundRate"))||void 0===n?void 0:n.value)||"5%",u=parseFloat(null===(o=document.getElementById("allowance"))||void 0===o?void 0:o.value)||0,d=parseFloat(null===(a=document.getElementById("otherBenefits"))||void 0===a?void 0:a.value)||0,s=(null===(r=document.getElementById("insuranceStatus"))||void 0===r?void 0:r.value)||"缴纳";if(l){var m=l,v=0,f=0,y=0,p=0,h=0;if("缴纳"===s&&i>0){if(v=this.calculateInsurancePersonal(i),f=this.calculateInsuranceCompany(i),"固定金额"===c){var g,E=parseFloat(null===(g=document.getElementById("customFundAmount"))||void 0===g?void 0:g.value)||0;y=E,p=E}else if("不缴纳"!==c){var I=parseFloat(c.replace("%",""))/100;y=i*I,p=i*I}var b=l-v-y-5e3;b>0&&(h=this.calculatePersonalTax(b)),m=l-v-y-h}var B=document.getElementById("afterTax");B&&(B.value=Math.round(100*m)/100),this.displayIncomeDetails({afterTax:m,insurancePersonal:v,insuranceCompany:f,fundPersonal:y,fundCompany:p,personalTax:h,totalIncome:m+y+p+u+d})}}},{key:"calculateInsurancePersonal",value:function(e){return e*(.1+.005)}},{key:"calculateInsuranceCompany",value:function(e){return.255*e}},{key:"calculatePersonalTax",value:function(e){var t;return t=e<=3e3?.03*e:e<=12e3?.1*e-210:e<=25e3?.2*e-1410:e<=35e3?.25*e-2660:e<=55e3?.3*e-4410:e<=8e4?.35*e-7160:.45*e-15160,Math.max(0,t)}},{key:"displayIncomeDetails",value:function(e){var t,n=document.getElementById("incomeDetails");if(n){var o=document.getElementById("insurancePersonal"),a=document.getElementById("insuranceCompany"),r=document.getElementById("fundPersonal"),l=document.getElementById("fundCompany"),i=document.getElementById("personalTax"),c=document.getElementById("effectiveTaxRate"),u=document.getElementById("totalIncome");o&&(o.textContent="¥".concat(Math.round(100*e.insurancePersonal)/100)),a&&(a.textContent="¥".concat(Math.round(100*e.insuranceCompany)/100)),r&&(r.textContent="¥".concat(Math.round(100*e.fundPersonal)/100)),l&&(l.textContent="¥".concat(Math.round(100*e.fundCompany)/100)),i&&(i.textContent="¥".concat(Math.round(100*e.personalTax)/100));var d=parseFloat(null===(t=document.getElementById("salary"))||void 0===t?void 0:t.value)||0,s=d>0?Math.round(e.personalTax/d*1e4)/100:0;c&&(c.textContent="".concat(s,"%")),u&&(u.textContent="¥".concat(Math.round(100*e.totalIncome)/100)),n.style.display="block"}}},{key:"loadExampleData",value:function(){document.getElementById("name").value="张三",document.getElementById("region").value="华北地区";var e=document.getElementById("region"),t=document.getElementById("city");e&&t&&(t.innerHTML='<option value="">请选择城市</option>',this.incomeCalculator.getCitiesByRegion("华北地区").forEach(function(e){var n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}),document.getElementById("city").value="北京"),document.getElementById("age").value="28",document.getElementById("education").value="硕士",document.getElementById("schoolRank").value="211院校",document.getElementById("familyDistance").value="跨省",document.getElementById("workType").value="外企",document.getElementById("salary").value="15000",document.getElementById("insuranceBase").value="15000",document.getElementById("fundRate").value="12%",document.getElementById("allowance").value="2000",document.getElementById("otherBenefits").value="500",document.getElementById("workStartTime").value="9",document.getElementById("workEndTime").value="18",document.getElementById("commuteTime").value="45",document.getElementById("overtimeFrequency").value="2",document.getElementById("overtimeHours").value="2",document.getElementById("workIntensity").value="4",document.getElementById("workDays").value="5",document.getElementById("rent").value="3500",document.getElementById("food").value="2500",document.getElementById("transport").value="300",document.getElementById("housingSatisfaction").value="7",document.getElementById("consumptionSatisfaction").value="8",document.getElementById("transportSatisfaction").value="6",document.getElementById("lifeAtmosphere").value="8",document.getElementById("workAtmosphere").value="7",this.calculateAfterTax(),alert('示例数据已加载完成！\n\n这是一个典型的北京外企工作案例：\n• 税前工资：15000元\n• 硕士学历，211院校\n• 跨省工作，外企类型\n• 工作强度适中\n• 生活成本较高\n\n点击"计算工作性价比"即可查看结果！')}},{key:"updateCityOptions",value:function(e){var t=document.getElementById("city");t&&(t.innerHTML='<option value="">请选择城市</option>',e&&this.incomeCalculator.getCitiesByRegion(e).forEach(function(e){var n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}))}},{key:"closeModal",value:function(){var e=document.getElementById("resultModal");e&&(e.style.display="none")}}],t&&E(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();document.addEventListener("DOMContentLoaded",function(){new b})})();